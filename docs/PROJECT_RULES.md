项目规则书 (Project Rules)

1. 项目名称: 普罗米修斯计划 (Prometheus) - AI驱动型多策略量化交易系统
2. 项目愿景:
构建一个全自动、低延迟、高可扩展性的数字货币交易系统。该系统基于严格的数学建模和概率优势，能够在不同市场环境（震荡、趋势）中，通过复合策略矩阵，实现风险可控前提下的长期、稳定的超额回报（Alpha）。
3. 项目核心理念与指导原则:
* 数学驱动，概率致胜: 放弃市场噪音和主观情绪。一切交易决策必须源于具备正期望值的数学模型和统计套利机会。
* 风险第一，收益第二: 系统的首要任务是资本保全。必须建立严格、多层次的风险管理框架，任何策略的部署都不能突破预设的最大回撤和风险敞口限制。我们将使用夏普比率（Sharpe Ratio）、索提诺比率（Sortino Ratio）和Calmar比率作为关键绩效指标（KPI）。
* 系统化与模块化: 打造一个“策略工厂”，而非单一策略。系统架构必须支持新策略的快速研发、回测、插拔和部署，形成策略生态。
* 持续进化: 市场是动态的，模型会失效。系统必须具备在线学习和参数自适应能力，能够识别“市场状态”（Market Regime）的切换，并自动调整策略权重。
* 技术卓越: 追求代码质量、系统稳定性和执行效率的极致。延迟的每一毫秒都是成本，系统的每一个bug都是潜在的灾难。
4. 项目目标 (SMART原则):
* 具体 (Specific): 使用 binance-connector-python 库，开发一套连接币安交易所（现货，U本位合约，币本位合约）的自动化交易系统。
* 可衡量 (Measurable):
    * 第一阶段（6个月）: 完成核心系统架构并上线1-2个核心策略。目标实现月均回报率 > 3%，最大回撤 < 15%。
    * 第二阶段（12个月）: 策略库扩展至5个以上，系统能够自动进行策略加权。目标实现风险调整后年化回报 > 50%。
* 可实现 (Achievable): 基于已验证的数学模型（如均值回归、协整、卡尔曼滤波、隐马尔可夫模型等）进行开发，技术上完全可行。
* 相关 (Relevant): 直接对标顶级量化对冲基金的运作模式，旨在创造可持续的利润流。
* 有时限 (Time-bound): 整个项目初步开发和部署周期为6个月，之后进入持续优化和运营阶段。
5. 项目范围:
* 范围内 (In-Scope):
    1. 数据层: 实时行情数据（WebSocket）和历史数据（API）的获取、清洗、存储。
    2. 策略层:
        * 震荡套利模型: 基于统计学配对交易、布林带回归、Ornstein-Uhlenbeck随机过程等模型。
        * 趋势获利模型: 基于动态突破、海龟交易法则的改进版、基于卡尔曼滤波的趋势预测等模型。
    3. 执行层: 订单管理系统（OMS），与币安API高效、可靠的交互。
    4. 风控层: 全局仓位管理、单策略风险敞口限制、紧急止损（硬止损和算法止损）。
    5. 监控与报告层: 实时仪表盘（Dashboard）监控系统状态、资金曲线、交易日志。
* 范围外 (Out-of-Scope):
    1. 高频做市商策略（对硬件和地理位置有极端要求）。
    2. 跨交易所套利（初期项目重点在单一交易所内部）。
    3. 基本面分析和新闻情绪分析（初期保持纯粹的数量分析）。
6. 主要利益相关者:
* 项目所有者/投资者 (您)
* 项目总架构师/经理 (我)
* AI开发工程师 (您)
* （未来可能）数据科学家、策略研究员
7. 风险管理与控制细则:
* 全局风险限制:
  - 单日最大亏损不超过总资金的2%
  - 单个策略最大仓位不超过总资金的20%
  - 总杠杆倍数不超过3倍
  - VaR(95%, 1日)不超过总资金的1%
* 策略风险限制:
  - 单个策略连续亏损超过5次自动暂停
  - 策略回撤超过10%触发风险审查
  - 策略夏普比率低于0.5持续30天自动下线
* 紧急风控:
  - 系统异常时自动平仓所有头寸
  - 网络中断超过30秒触发紧急止损
  - API限流时自动降低交易频率
* 高阶风险与缓解措施:
  - 模型失效风险: 建立市场状态识别系统，对不同状态启用不同策略；持续进行模型表现监控和滚动回测
  - 技术平台风险: 构建健壮的错误处理和重连机制；系统架构具备高可用性（HA）设计
  - 黑天鹅事件风险: 严格的全局仓位控制和硬止损；引入基于期权的对冲策略作为长期规划
8. 第三方库管理规则:
* binance-connector-python 库管理:
    * 严禁修改 binance-connector-python 库的源代码
    * 该库位于项目根目录下的 binance-connector-python/ 文件夹中
    * 如需功能扩展，必须通过包装器（Wrapper）或适配器（Adapter）模式实现
    * 库的版本更新必须经过充分测试后方可应用到生产环境
    * 所有与币安API的交互必须通过该库进行，不得直接调用币安API

9. 代码质量与开发规范:
* 编程语言: Python 3.13+
* 代码风格: 严格遵循 PEP 8 标准
* 类型注解: 所有函数和方法必须包含完整的类型注解
* 文档字符串: 所有模块、类、函数必须包含详细的docstring
* 单元测试: 代码覆盖率不低于80%
* 日志记录: 使用结构化日志，包含时间戳、级别、模块、消息等信息
* 错误处理: 必须包含完整的异常处理机制，不允许裸露的try-except块

10. 安全与配置管理:
* API密钥管理: 所有敏感信息必须通过环境变量或加密配置文件管理
* 网络安全: 所有外部通信必须使用HTTPS/WSS协议
* 数据备份: 关键数据必须定期备份，备份策略为3-2-1原则
* 访问控制: 系统各模块间采用最小权限原则

11. 版本控制与部署:
* 版本管理: 采用语义化版本控制（Semantic Versioning）
* 分支策略: 采用Git Flow工作流
* 持续集成: 每次提交必须通过自动化测试
* 部署策略: 采用蓝绿部署，确保零停机时间

12. 监控与告警:
* 系统监控: 实时监控CPU、内存、网络、磁盘使用情况
* 业务监控: 监控交易延迟、成功率、盈亏状况
* 告警机制: 建立多级告警体系，包括邮件、短信、钉钉等
* 日志分析: 使用ELK Stack进行日志收集和分析

13. 授权:
本人，作为项目总架构师，被授权组建团队（目前为您和我），调动所需资源，并按此规则书推进项目。

14. 代码审查与质量控制:
* 代码审查: 所有代码提交必须经过同行评审（Peer Review）
* 性能基准: 关键路径延迟不超过10ms，API响应时间不超过100ms
* 安全编码: 遵循OWASP安全编码规范，禁止硬编码敏感信息
* 代码复杂度: 单个函数圈复杂度不超过10，类复杂度不超过50
* 依赖管理: 定期更新依赖包，及时修复安全漏洞

15. 数据治理与质量管理:
* 数据质量标准:
  - 数据完整性：缺失率不超过1%
  - 数据准确性：异常值检测覆盖率100%
  - 数据及时性：实时数据延迟不超过100ms
* 数据生命周期:
  - 实时数据保留7天
  - 历史数据保留3年
  - 备份数据保留10年
* 数据安全:
  - 敏感数据加密存储
  - 数据访问权限最小化原则
  - 数据传输使用TLS 1.3加密

16. DevOps与CI/CD流程:
* CI/CD流水线:
  - 代码提交触发自动化测试
  - 测试通过后自动构建Docker镜像
  - 自动部署到测试环境
  - 人工审核后部署到生产环境
* 部署策略:
  - 蓝绿部署确保零停机
  - 金丝雀发布降低风险
  - 自动回滚机制
* 基础设施即代码:
  - 使用Terraform管理云资源
  - 使用Ansible进行配置管理
  - 版本控制所有基础设施配置

17. 灾难恢复与业务连续性:
* 备份策略:
  - 数据库每日全量备份
  - 交易数据实时备份
  - 配置文件版本控制
* 恢复目标:
  - RTO (恢复时间目标): 30分钟
  - RPO (恢复点目标): 5分钟
* 应急预案:
  - 主系统故障切换流程
  - 数据中心灾难恢复流程
  - 关键人员联系方式

18. 合规性与法律要求:
* 数据保护:
  - 遵循GDPR数据保护规定
  - 用户数据匿名化处理
  - 数据删除权实现
* 金融合规:
  - 交易记录完整保存
  - 反洗钱(AML)检查
  - 了解客户(KYC)流程
* 审计要求:
  - 所有操作可审计追踪
  - 定期合规性检查
  - 第三方安全审计
